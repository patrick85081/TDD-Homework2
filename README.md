# TDD-Homework2

## 題目情境
哈利波特一到五冊熱潮正席捲全球，世界各地的孩子都為之瘋狂。
出版社為了慶祝Agile Tour第一次在台灣舉辦，決定訂出極大的優惠，來回饋給為了小孩四處奔波買書的父母親們。
定價的方式如下：

1. 一到五集的哈利波特，每一本都是賣100元 
2. 如果你從這個系列買了兩本不同的書，則會有5%的折扣 
3. 如果你買了三本不同的書，則會有10%的折扣  
4. 如果是四本不同的書，則會有20%的折扣  
5. 如果你一次買了整套一到五集，恭喜你將享有25%的折扣
6. 需要留意的是，如果你買了四本書，其中三本不同，第四本則是重複的，那麼那三本將享有10%的折扣，但重複的那一本，則仍須100元。  

你的任務是，設計一個哈利波特的購物車，能提供最便宜的價格給這些爸爸媽媽。

#### Feature: PotterShoppingCart  
In order to 提供最便宜的價格給來買書的爸爸媽媽. As a 佛心的出版社老闆.I want to 設計一個哈利波特的購物車

#### Scenario: 第一集買了一本，其他都沒買，價格應為100*1=100元
- Given 第一集買了 1 本
- And 第二集買了 0 本
- And 第三集買了 0 本
- And 第四集買了 0 本
- And 第五集買了 0 本
- When 結帳
- Then 價格應為 100 元

#### Scenario: 第一集買了一本，第二集也買了一本，價格應為100*2*0.95=190
- Given 第一集買了 1 本
- And 第二集買了 1 本
- And 第三集買了 0 本
- And 第四集買了 0 本
- And 第五集買了 0 本
- When 結帳
- Then 價格應為 190 元

#### Scenario: 一二三集各買了一本，價格應為100*3*0.9=270
- Given 第一集買了 1 本
- And 第二集買了 1 本
- And 第三集買了 1 本
- And 第四集買了 0 本
- And 第五集買了 0 本
- When 結帳
- Then 價格應為 270 元

#### Scenario: 一二三四集各買了一本，價格應為100*4*0.8=320
- Given 第一集買了 1 本
- And 第二集買了 1 本
- And 第三集買了 1 本
- And 第四集買了 1 本
- And 第五集買了 0 本
- When 結帳
- Then 價格應為 320 元

#### Scenario: 一次買了整套，一二三四五集各買了一本，價格應為100*5*0.75=375
- Given 第一集買了 1 本
- And 第二集買了 1 本
- And 第三集買了 1 本
- And 第四集買了 1 本
- And 第五集買了 1 本
- When 結帳
- Then 價格應為 375 元

#### Scenario: 一二集各買了一本，第三集買了兩本，價格應為100*3*0.9 + 100 = 370
- Given 第一集買了 1 本
- And 第二集買了 1 本
- And 第三集買了 2 本
- And 第四集買了 0 本
- And 第五集買了 0 本
- When 結帳
- Then 價格應為 370 元

#### Scenario: 第一集買了一本，第二三集各買了兩本，價格應為100*3*0.9 + 100*2*0.95 = 460
- Given 第一集買了 1 本
- And 第二集買了 2 本
- And 第三集買了 2 本
- And 第四集買了 0 本
- And 第五集買了 0 本
- When 結帳
- Then 價格應為 460 元

### 個人思路
此題目總共有五個測試需求，但是不是一次寫完，而是寫完一個Commit一次，用意應該是模擬現實狀況，需求是隨著時間出現，一開始的需求往往不是最後的結果。  

### 購物車API 設計思路  
一個商場可能會同時包含多種的價格計算方式(優惠價格)，所以我認為應該將價格計算方式抽象出來定義一個```interface```，購物車內使用```IDictionary```來記錄購買商品以及數量。
```c#
IDictionary<Product, int> product;
```
設計此```interface```來計算商品金額  
```c#
/// <summary>  
/// 商品計算方式  
/// </summary>  
public interface ICalculate  
{  
    /// <summary>  
    /// 計算產品總金額  
    /// </summary>  
    /// <param name="products">購買產品清單及數量</param>  
    /// <returns>總金額</returns>  
    double Calculate(IDictionary<Product, int> products);  
}  
```
因為未來可能有多種優惠價格的計算方式會並存，所以這裡我選擇用```裝飾者模式```來設計，將多個```ICalculate```疊加計算。